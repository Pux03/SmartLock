<div
  class="locker-container"
  [class.edit-mode]="isInEditMode"
  [class.hovered]="isHovered"
  (mouseenter)="isHovered = true"
  (mouseleave)="isHovered = false"
>
  <div class="button-row top-button">
    <button
      *ngIf="!viewMode && !editMode && isPositionFree(locker.x, locker.y - 1) && locker.y - 1 > -3"
      (click)="addLockerDirection('top')"
      class="direction-btn"
      title="Add Above"
    >
      ↑
    </button>
  </div>

  <div class="middle-section">
    <div class="side-button">
      <button
        *ngIf="
          !viewMode && !editMode && isPositionFree(locker.x - 1, locker.y) && locker.x - 1 > -4
        "
        (click)="addLockerDirection('left')"
        class="direction-btn"
        title="Add Left"
      >
        ←
      </button>
    </div>

    <div class="input-container">
      <input
        type="text"
        [value]="isInEditMode ? localLocker.serial : locker.serial"
        (input)="updateLocalSerial($any($event.target).value)"
        [placeholder]="isReadOnly ? 'No Serial' : 'Enter Serial'"
        [readonly]="isReadOnly"
        [class.edit-active]="isInEditMode"
        [class.readonly]="isReadOnly"
        class="locker-input"
      />

      <div class="user-assignment" *ngIf="viewMode && locker.status === 'FREE' && companyId">
        <select [(ngModel)]="selectedUserId" class="user-select" [disabled]="loading">
          <option [ngValue]="null">Assign user</option>
          <option *ngFor="let user of usersWithoutLockers" [ngValue]="user.id">
            {{ user.firstName }} {{ user.lastName }} ({{ user.email }})
          </option>
        </select>
        <button
          (click)="assignUserToLocker()"
          class="assign-btn"
          [disabled]="!selectedUserId || loading"
        >
          {{ loading ? 'Assigning...' : 'Assign' }}
        </button>
      </div>
    </div>

    <div class="side-button">
      <button
        *ngIf="!viewMode && !editMode && isPositionFree(locker.x + 1, locker.y) && locker.x + 1 < 4"
        (click)="addLockerDirection('right')"
        class="direction-btn"
        title="Add Right"
      >
        →
      </button>
    </div>
  </div>

  <div class="button-row bottom-button">
    <button
      *ngIf="!viewMode && !editMode && isPositionFree(locker.x, locker.y + 1) && locker.y + 1 < 3"
      (click)="addLockerDirection('bottom')"
      class="direction-btn"
      title="Add Below"
    >
      ↓
    </button>
  </div>

  <div class="locker-info">
    <div class="position-indicator">({{ locker.x }}, {{ locker.y }})</div>
    <div class="status" [ngStyle]="{ color: getStatusColor(locker.status) }">
      {{ locker.status }}
    </div>
  </div>
</div>
